<% title("Customers") %>

<%= display_flash(flash) %>
<div class="content-box"><!-- Start Content Box -->

	<div class="content-box-header" style="height: 20px;">
		<%= link_to_function "&nbsp;", "$(this).toggleClass('on'); $('#filters_bar').slideToggle(); $('#filters_button').slideToggle();", :id => "filters_toggle" %>
		<div class="clear"></div>
	</div>
	
	<div id="filters_bar" style="display: none;">
	  <%- form_tag "/customers", :method => :get do -%>
          <ul>
            <% Customer.aasm_states.each do |state| %>
              <li>
                <input type="checkbox"  name="filters[<%= state.name %>]"  value="on"
                         <% if @filters.include? state.name.to_s %>
                          checked="checked"
                         <% end %>/>
                <%= state.name.to_s.split("_").join(" ").titleize %>
              </li>
            <% end %>
          </ul>
          <div id="filters_button" style="float: right; display: none;">
            <input type="image" src="/images/btn-apply-filters.png" border="0" width="126" height="22" style="width: 126px; height: 22px;" />
          </div>
          <%- end -%>
          <div class="clear"></div>
	</div>

  <div class="content-box-content">

    <% if !flash[:notice].blank? %>
  		<div class="notification attention png_bg">
  			<a href="#" class="close"><img src="/images/icons/cross_grey_small.png" title="Close this notification" alt="close" /></a>
  			<div>
  				<%= flash[:notice] %>
  			</div>
  		</div>
  	<% end %>

  	<%= render :partial => "/includes/customers_grid", :locals => { :customers => @customers } %>
  	
  </div>

</div>