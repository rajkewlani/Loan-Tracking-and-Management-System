<% title("Lead Providers") %>
<% subtitle("List of the lead providers that post in leads via the API.")%>

<div class="content-box"><!-- Start Content Box -->

  <div class="content-box-header">

    <ul class="content-box-tabs">
      <li><a href="#tab1" class="default-tab">List</a></li> <!-- href must be unique and match the id of target div -->
      <li><a href="#tab2">Create</a></li>
    </ul>

    <div class="clear"></div>

  </div> <!-- End .content-box-header -->

  <div class="content-box-content">

    <%= display_flash(flash) %>

    <div class="tab-content default-tab" id="tab1">

      <table>

        <thead>
          <tr>
            <th>Name</th>
            <th>Filter</th>
            <th>Status</th>
            <th># Received</th>
            <th># Purchased</th>
            <th>&nbsp;</th>
          </tr>

        </thead>

        <tfoot>
          <tr>
            <td colspan="7">
              <%= will_paginate @lead_providers %>
              <div class="clear"></div>
            </td>
          </tr>
        </tfoot>

        <tbody>
          <% @lead_providers.each do |lead_provider| %>
            <tr>
              <td><%= lead_provider.name %></td>
              <td><%= link_to lead_provider.lead_filter.name, edit_lead_filter_path(lead_provider.lead_filter) %></td>
              <td><%= lead_provider.display_status %></td>
              <td><%= link_to lead_provider.customers.count, lead_provider_path(lead_provider) %></td>
              <td><%= Customer.purchased("purchased",lead_provider.id).count %></td>
              <td class="icons">
                <%= link_to image_tag("icons/pencil.png", :title => "Edit", :alt => "Edit"), edit_lead_provider_path(lead_provider) %>
                <%= link_to image_tag("icons/cross.png", :title => "Delete", :alt => "Delete"), lead_provider_path(lead_provider), :method => :delete, :confirm => "Are you sure?" %>
              </td>
            </tr>
          <% end %>
        </tbody>

      </table>

    </div>

    <div class="tab-content" id="tab2">
      <% form_for LeadProvider.new do |f| %>
        <%= render :partial => "form", :locals => { :f => f } %>
      <% end %>
    </div>

  </div>

</div>